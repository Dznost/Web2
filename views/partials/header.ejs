<nav class="navbar navbar-expand-lg navbar-dark fixed-top">
	<div class="container">
		<a class="navbar-brand d-flex align-items-center" href="/">
			<i class="fas fa-book-open me-2"></i>
			<span class="brand-text">Thư viện trực tuyến</span>
		</a>

		<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
			<span class="navbar-toggler-icon"></span>
		</button>

		<div class="collapse navbar-collapse" id="navbarNav">
			<ul class="navbar-nav mx-auto">
				<li class="nav-item">
					<a class="nav-link" href="/books">
						<i class="fas fa-search me-1"></i>
						<span>Tra cứu sách</span>
					</a>
				</li>

				<% if (user) { %>
				<li class="nav-item">
					<a class="nav-link position-relative" href="/user/cart">
						<i class="fas fa-shopping-cart me-1"></i>
						<span>Giỏ hàng</span>
					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="/user/rules">
						<i class="fas fa-file-alt me-1"></i>
						<span>Quy định</span>
					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="/user/request">
						<i class="fas fa-plus-circle me-1"></i>
						<span>Yêu cầu sách</span>
					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link position-relative" href="/user/notifications">
						<i class="fas fa-bell me-1"></i>
						<span>Thông báo</span>
						<% if (typeof unreadCount !== 'undefined' && unreadCount > 0) { %>
						<span class="notification-badge">
							<%= unreadCount %>
						</span>
						<% } %>
					</a>
				</li>

				<% if (user.role === 'librarian' || user.role === 'admin') { %>
				<li class="nav-item dropdown">
					<a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
						<i class="fas fa-user-tie me-1"></i>
						<span>Thủ thư</span>
					</a>
					<ul class="dropdown-menu dropdown-menu-modern">
						<li>
							<a class="dropdown-item" href="/librarian/check-code">
								<i class="fas fa-qrcode me-2"></i>
								<span>Kiểm tra mã</span>
							</a>
						</li>
						<li>
							<a class="dropdown-item" href="/librarian/update-status?type=borrow">
								<i class="fas fa-book me-2"></i>
								<span>Xác nhận mượn sách</span>
							</a>
						</li>
						<li>
							<a class="dropdown-item" href="/librarian/update-status?type=return">
								<i class="fas fa-undo me-2"></i>
								<span>Xác nhận trả sách</span>
							</a>
						</li>
						<li>
							<a class="dropdown-item" href="/librarian/payment">
								<i class="fas fa-wallet me-2"></i>
								<span>Thanh toán</span>
							</a>
						</li>
					</ul>
				</li>
				<% } %>

				<% if (user.role === 'admin') { %>
				<li class="nav-item dropdown">
					<a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
						<i class="fas fa-cog me-1"></i>
						<span>Quản lý</span>
					</a>
					<ul class="dropdown-menu dropdown-menu-modern">
						<li>
							<a class="dropdown-item" href="/admin/add-book">
								<i class="fas fa-plus me-2"></i>
								<span>Thêm sách</span>
							</a>
						</li>
						<li>
							<a class="dropdown-item" href="/admin/distribute">
								<i class="fas fa-share-alt me-2"></i>
								<span>Phân bố sách</span>
							</a>
						</li>
						<li>
							<a class="dropdown-item" href="/admin/statistics">
								<i class="fas fa-chart-bar me-2"></i>
								<span>Thống kê</span>
							</a>
						</li>
						<li>
							<a class="dropdown-item" href="/admin/ban-user">
								<i class="fas fa-ban me-2"></i>
								<span>Cấm người dùng</span>
							</a>
						</li>
					</ul>
				</li>
				<% } %>
				<% } %>
			</ul>

			<ul class="navbar-nav">
				<% if (user) { %>
				<li class="nav-item dropdown">
					<a class="nav-link dropdown-toggle user-dropdown" href="#" role="button" data-bs-toggle="dropdown">
						<div class="user-avatar">
							<i class="fas fa-user"></i>
						</div>
						<span class="user-name">
							<%= user.fullName %>
						</span>
					</a>
					<ul class="dropdown-menu dropdown-menu-end dropdown-menu-modern">
						<li>
							<div class="dropdown-header">
								<strong>
									<%= user.fullName %>
								</strong>
								<small class="d-block text-muted mt-1">
									<i class="fas fa-shield-alt me-1"></i><%= user.role %>
								</small>
							</div>
						</li>
						<li>
							<hr class="dropdown-divider">
						</li>
						<li>
							<a class="dropdown-item" href="/auth/logout">
								<i class="fas fa-sign-out-alt me-2"></i>
								<span>Đăng xuất</span>
							</a>
						</li>
					</ul>
				</li>
				<% } else { %>
				<li class="nav-item">
					<a class="nav-link btn-nav-auth" href="/auth/login">
						<i class="fas fa-sign-in-alt me-1"></i>
						<span>Đăng nhập</span>
					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link btn-nav-register" href="/auth/register">
						<i class="fas fa-user-plus me-1"></i>
						<span>Đăng ký</span>
					</a>
				</li>
				<% } %>
			</ul>
		</div>
	</div>
</nav>

<!-- Spacer for fixed navbar -->
<div style="height: 76px;"></div>