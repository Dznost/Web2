<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
	<div class="container">
		<a class="navbar-brand" href="/">
			<i class="fas fa-book-open me-2"></i>
			Thư viện trực tuyến
		</a>

		<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
			<span class="navbar-toggler-icon"></span>
		</button>

		<div class="collapse navbar-collapse" id="navbarNav">
			<ul class="navbar-nav me-auto">
				<li class="nav-item">
					<a class="nav-link" href="/books">
						<i class="fas fa-search me-1"></i>
						Tra cứu sách
					</a>
				</li>

				<% if (user) { %>
				<li class="nav-item">
					<a class="nav-link" href="/user/cart">
						<i class="fas fa-shopping-cart me-1"></i>
						Giỏ hàng
					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="/user/rules">
						<i class="fas fa-file-alt me-1"></i>
						Quy định
					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="/user/request">
						<i class="fas fa-plus-circle me-1"></i>
						Yêu cầu sách
					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link position-relative" href="/user/notifications">
						<i class="fas fa-bell me-1"></i>
						Thông báo
						<% if (typeof unreadCount !== 'undefined' && unreadCount > 0) { %>
						<span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
							<%= unreadCount %>
						</span>
						<% } %>
					</a>
				</li>

				<% if (user.role === 'librarian' || user.role === 'admin') { %>
				<li class="nav-item dropdown">
					<a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
						<i class="fas fa-user-tie me-1"></i>
						Thủ thư
					</a>
					<ul class="dropdown-menu">
						<li>
							<a class="dropdown-item" href="/librarian/check-code">
								<i class="fas fa-qrcode me-2"></i>Kiểm tra mã
							</a>
						</li>
						<li>
							<a class="dropdown-item" href="/librarian/update-status?type=borrow">
								<i class="fas fa-book me-2"></i>Xác nhận mượn sách
							</a>
						</li>
						<li>
							<a class="dropdown-item" href="/librarian/update-status?type=return">
								<i class="fas fa-undo me-2"></i>Xác nhận trả sách
							</a>
						</li>
						<li>
							<a class="dropdown-item" href="/librarian/payment">
								<i class="fas fa-wallet me-2"></i>Thanh toán
							</a>
						</li>
					</ul>
				</li>
				<% } %>

				<% if (user.role === 'admin') { %>
				<li class="nav-item dropdown">
					<a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
						<i class="fas fa-cog me-1"></i>
						Quản lý
					</a>
					<ul class="dropdown-menu">
						<li>
							<a class="dropdown-item" href="/admin/add-book">
								<i class="fas fa-plus me-2"></i>Thêm sách
							</a>
						</li>
						<li>
							<a class="dropdown-item" href="/admin/distribute">
								<i class="fas fa-share-alt me-2"></i>Phân bố sách
							</a>
						</li>
						<li>
							<a class="dropdown-item" href="/admin/statistics">
								<i class="fas fa-chart-bar me-2"></i>Thống kê
							</a>
						</li>
						<li>
							<a class="dropdown-item" href="/admin/ban-user">
								<i class="fas fa-ban me-2"></i>Cấm người dùng
							</a>
						</li>
					</ul>
				</li>
				<% } %>
				<% } %>
			</ul>

			<ul class="navbar-nav">
				<% if (user) { %>
				<li class="nav-item dropdown">
					<a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
						<i class="fas fa-user me-1"></i>
						<%= user.fullName %>
					</a>
					<ul class="dropdown-menu">
						<li>
							<span class="dropdown-item-text">
								<small class="text-muted">
									Vai trò: <%= user.role %>
								</small>
							</span>
						</li>
						<li>
							<hr class="dropdown-divider">
						</li>
						<li>
							<a class="dropdown-item" href="/auth/logout">
								<i class="fas fa-sign-out-alt me-2"></i>Đăng xuất
							</a>
						</li>
					</ul>
				</li>
				<% } else { %>
				<li class="nav-item">
					<a class="nav-link" href="/auth/login">
						<i class="fas fa-sign-in-alt me-1"></i>
						Đăng nhập
					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="/auth/register">
						<i class="fas fa-user-plus me-1"></i>
						Đăng ký
					</a>
				</li>
				<% } %>
			</ul>
		</div>
	</div>
</nav>
